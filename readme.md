# ivoo.re Website + Vercel Serverless Backend

This project is ready for low-cost deployment on Vercel with a Supabase database.

## What is included

- Static storefront (`/index.html`, `/app.js`, `/styles.css`)
- Serverless APIs:
  - `POST /api/create-order`
  - `GET /api/orders` (admin key protected)
  - `POST /api/payment-status` (admin key protected)
  - `POST /api/paytm-webhook` (webhook token protected)
- Basic owner panel: `/admin.html`

## 1) Supabase table setup

Run this SQL in Supabase SQL Editor:

```sql
create table if not exists public.orders (
  id bigint generated by default as identity primary key,
  created_at timestamptz not null default now(),
  order_id text unique not null,
  customer_email text,
  customer_name text not null,
  customer_phone text not null,
  shipping_address text not null,
  notes text,
  items_json jsonb not null,
  amount_subtotal numeric(10,2) not null default 0,
  amount_shipping numeric(10,2) not null default 0,
  amount_total numeric(10,2) not null,
  currency text not null default 'INR',
  payment_status text not null default 'pending',
  order_status text not null default 'created',
  gateway_txn_ref text,
  source text not null default 'website'
);
```

## 2) Vercel environment variables

Set these in Vercel Project Settings -> Environment Variables:

- `SUPABASE_URL`
- `SUPABASE_SERVICE_ROLE_KEY`
- `ADMIN_API_KEY` (any strong random string)
- `PAYMENT_WEBHOOK_TOKEN` (any strong random string)
- `UPI_ID` (example: `yourname@paytm`)

## 3) Security notes

- Never expose `SUPABASE_SERVICE_ROLE_KEY` to frontend.
- `ADMIN_API_KEY` is required for `/admin.html` to load order data.
- `PAYMENT_WEBHOOK_TOKEN` is required in header `x-webhook-token` for `/api/paytm-webhook`.

## 4) Payment flow currently implemented

1. Customer places order from checkout modal.
2. `/api/create-order` stores order in Supabase as `pending`.
3. If `UPI_ID` is configured, app opens a UPI payment link.
4. Payment status is updated when webhook/manual status endpoint is called.

## 5) Domain setup (GoDaddy -> Vercel)

- `A @` -> `76.76.21.21`
- `CNAME www` -> `cname.vercel-dns.com`

## 6) Local test

```bash
vercel dev
```

Then open:

- `http://localhost:3000/` for storefront
- `http://localhost:3000/admin.html` for owner dashboard
